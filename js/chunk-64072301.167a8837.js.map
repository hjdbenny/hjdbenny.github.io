{"version":3,"sources":["webpack:///./src/views/Personal.vue?d750","webpack:///./src/views/Personal.vue","webpack:///./src/views/Personal.vue?6770","webpack:///./node_modules/core-js/modules/es.function.name.js"],"names":["class","model","$store","state","userInfo","rules","ref","label-width","label","prop","action","uploadUrl","accept","headers","uploadHeaders","show-file-list","on-success","handleAvatarSuccess","before-upload","beforeAvatarUpload","avatarUrl","src","name","nickname","age","min","max","style","type","submitForm","data","Authorization","this","avatar","required","message","trigger","methods","res","file","localStorage","getItem","isJPG","isLt2M","size","$message","error","formName","$refs","validate","valid","updateUserInfo","commit","key","value","$api","user","then","$router","push","path","success","mounted","dispatch","render","DESCRIPTORS","defineProperty","f","FunctionPrototype","Function","prototype","FunctionPrototypeToString","toString","nameRE","NAME","configurable","get","call","match"],"mappings":"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","file":"js/chunk-64072301.167a8837.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Personal.vue?vue&type=style&index=0&id=2386ea81&lang=scss\"","<template>\r\n    <div class=\"personal-wrapper\">\r\n        <div class=\"title\">编辑个人信息</div>\r\n        <el-form :model=\"$store.state.userInfo\" :rules=\"rules\" ref=\"infoForm\" label-width=\"100px\" class=\"infoForm\">\r\n            <el-form-item label=\" 用户头像\" prop=\"avatar\">\r\n                <el-upload class=\"avatar-uploader\" :action=\"uploadUrl\" accept=\"image/jpeg\" :headers=\"uploadHeaders\" :show-file-list=\"false\" :on-success=\"handleAvatarSuccess\" :before-upload=\"beforeAvatarUpload\">\r\n                    <img v-if=\"avatarUrl\" :src=\"avatarUrl\" class=\"avatar\">\r\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                </el-upload>\r\n            </el-form-item>\r\n            <el-form-item label=\"账户名称\" prop=\"name\">\r\n                <el-input v-model=\"$store.state.userInfo.name\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"昵称\" prop=\"nickname\">\r\n                <el-input v-model=\"$store.state.userInfo.nickname\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"年龄\" prop=\"age\">\r\n                <el-input-number v-model=\"$store.state.userInfo.age\" :min=\"1\" :max=\"99\"></el-input-number>\r\n            </el-form-item>\r\n            <el-form-item style=\"margin-bottom:0\">\r\n                <a-button type=\"primary\" @click=\"submitForm('infoForm')\">保存</a-button>\r\n            </el-form-item>\r\n        </el-form>\r\n\r\n    </div>\r\n</template>\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            uploadUrl: `${process.env.VUE_APP_SERVER_URL}/api/common/uploadImage`,\r\n            uploadHeaders: {\r\n                Authorization: '',\r\n            },\r\n            avatarUrl: this.$store.state.userInfo.avatar,\r\n            rules: {\r\n                name: [\r\n                    {\r\n                        required: true,\r\n                        message: '请输入账户名称',\r\n                        trigger: 'blur',\r\n                    },\r\n                    {\r\n                        min: 3,\r\n                        max: 5,\r\n                        message: '长度在 3 到 5 个字符',\r\n                        trigger: 'blur',\r\n                    },\r\n                ],\r\n                nickname: [\r\n                    { required: true, message: '请输入昵称', trigger: 'blur' },\r\n                ],\r\n                age: [{ required: true }],\r\n            },\r\n        }\r\n    },\r\n    methods: {\r\n        handleAvatarSuccess(res) {\r\n            this.avatarUrl = res.data\r\n        },\r\n        beforeAvatarUpload(file) {\r\n            this.uploadHeaders.Authorization = localStorage.getItem('token')\r\n            const isJPG = file.type === 'image/jpeg'\r\n            const isLt2M = file.size / 1024 / 1024 < 2\r\n\r\n            if (!isJPG) {\r\n                this.$message.error('上传头像图片只能是 JPG 格式!')\r\n            }\r\n            if (!isLt2M) {\r\n                this.$message.error('上传头像图片大小不能超过 2MB!')\r\n            }\r\n            return isJPG && isLt2M\r\n        },\r\n        submitForm(formName) {\r\n            this.$refs[formName].validate((valid) => {\r\n                if (valid) {\r\n                    this.updateUserInfo()\r\n                } else {\r\n                    return false\r\n                }\r\n            })\r\n        },\r\n        updateUserInfo() {\r\n            this.$store.commit('updateUserInfo', {\r\n                key: 'avatar',\r\n                value: this.avatarUrl,\r\n            })\r\n            this.$api.user\r\n                .updateUserInfo(this.$store.state.userInfo)\r\n                .then(() => {\r\n                    this.$router.push({ path: '/home' })\r\n                    this.$message.success('更新成功')\r\n                })\r\n        },\r\n    },\r\n    mounted() {\r\n        this.$store.dispatch('getUserInfo')\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.personal-wrapper {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    .title {\r\n        margin-bottom: 16px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .infoForm {\r\n        .avatar-uploader .el-upload {\r\n            border: 1px dashed #000;\r\n            border-radius: 6px;\r\n            cursor: pointer;\r\n            position: relative;\r\n            overflow: hidden;\r\n        }\r\n        .avatar-uploader .el-upload:hover {\r\n            border-color: #409eff;\r\n        }\r\n        .avatar-uploader-icon {\r\n            font-size: 28px;\r\n            color: #8c939d;\r\n            width: 128px;\r\n            height: 128px;\r\n            line-height: 128px;\r\n            text-align: center;\r\n        }\r\n        .avatar {\r\n            width: 128px;\r\n            height: 128px;\r\n            display: block;\r\n        }\r\n        .el-form-item__label {\r\n            text-align: left;\r\n        }\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./Personal.vue?vue&type=template&id=2386ea81\"\nimport script from \"./Personal.vue?vue&type=script&lang=js\"\nexport * from \"./Personal.vue?vue&type=script&lang=js\"\n\nimport \"./Personal.vue?vue&type=style&index=0&id=2386ea81&lang=scss\"\nscript.render = render\n\nexport default script","var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.github.io/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n"],"sourceRoot":""}